"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["packages_agent-sessions_utils_elapsed-time-util_ts-packages_hydro-analytics_hydro-analytics_t-e23c79"],{67154:(e,t,r)=>{function n(e){return"object"==typeof e&&null!==e&&"choices"in e&&Array.isArray(e.choices)}r.d(t,{Qx:()=>n,Yj:()=>o,wG:()=>i});let o={InProgress:"in_progress",Completed:"completed",Failed:"failed",Idle:"idle",WaitingForUser:"waiting_for_user",TimedOut:"timed_out",Cancelled:"cancelled",Queued:"queued"};function i(e){switch(e){case o.InProgress:return"In progress";case o.Completed:return"Ready for review";case o.Failed:return"Failed";case o.Idle:return"Idle";case o.WaitingForUser:return"Waiting for user";case o.TimedOut:return"Timed out";case o.Cancelled:return"Cancelled";case o.Queued:return"Queued";default:return"Unknown"}}},77367:(e,t,r)=>{r.d(t,{Y:()=>n});function n(e,t){let r=new Date(e).getTime(),n=Math.floor(((t&&"0001-01-01T00:00:00Z"!==t?new Date(t).getTime():Date.now())-r)/1e3),o=[{value:Math.floor(n/86400),label:"d"},{value:Math.floor(n%86400/3600),label:"h"},{value:Math.floor(n%3600/60),label:"m"},{value:n%60,label:"s"}].filter(e=>e.value>0);return 0===o.length?"0s":1===o.length?`${o[0]?.value??0}${o[0]?.label??""}`:o[1]?`${o[0]?.value}${o[0]?.label} ${o[1].value}${o[1].label??""}`:`${o[0]?.value??0}${o[0]?.label??""}`}},51120:(e,t,r)=>{r.d(t,{I:()=>a,j:()=>FetchCAPI401Error});var n=r(34295),o=r(99505),i=r(21067);let FetchCAPI401Error=class FetchCAPI401Error extends Error{constructor(e){super(e),this.name="FetchCAPI401Error"}};async function a({path:e,method:t="GET",streamingResponse:r=!1,body:a}){let s=new n.l,l=await s.getAuthToken();if(!l)throw Error("No token available");let u={authToken:l,basePath:(0,i._$)().copilotApiOverrideUrl??"https://api.githubcopilot.com",method:t,path:e,streamingResponse:r,body:a},c=await (0,o.p)(u);if(!c.ok){if(401===c.status)throw new FetchCAPI401Error("Unauthorized access - token may be invalid or expired");throw Error("Failed to fetch agent sessions")}return c}},34295:(e,t,r)=>{r.d(t,{l:()=>AgentSessionsTokenProvider});var n=r(65411);let AgentSessionsTokenProvider=class AgentSessionsTokenProvider extends n.J{constructor(){super([],"/copilot/agent-sessions/token","AGENT_SESSIONS_TOKEN")}}},65620:(e,t,r)=>{r.d(t,{Y:()=>AuthToken});var n=r(50467);let AuthToken=class AuthToken{get authorizationHeaderValue(){return`GitHub-Bearer ${this.value}`}needsRefreshing(e){return this.isExpired||this.ssoChanged(e)}get isExpired(){let e=new Date(this.expiration);return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))<new Date(Date.now()+15e3)}ssoChanged(e){return!(this.ssoOrgIDs.every(t=>e.includes(t))&&e.every(e=>this.ssoOrgIDs.includes(e)))}static fromResult(e,t){return new AuthToken(e.token,e.expiration,t)}serialize(){return{value:this.value,expiration:this.expiration,ssoOrgIDs:this.ssoOrgIDs}}static deserialize(e){return new AuthToken(e.value,e.expiration,e.ssoOrgIDs)}constructor(e,t,r){(0,n._)(this,"value",void 0),(0,n._)(this,"expiration",void 0),(0,n._)(this,"ssoOrgIDs",void 0),this.value=e,this.expiration=t,this.ssoOrgIDs=r}}},65411:(e,t,r)=>{r.d(t,{J:()=>CopilotAuthTokenProvider});var n=r(50467),o=r(65620),i=r(82075),a=r(96379);let CopilotAuthTokenProvider=class CopilotAuthTokenProvider{async getAuthToken(){let e=this.getLocalStorageAuthToken();return e?this.validateAuthToken(e):this.fetchAuthToken()}setLocalStorageAuthToken(e){this.copilotLocalStorage.setItem(this.storageKey,JSON.stringify(e.serialize()))}getLocalStorageAuthToken(){let e=this.copilotLocalStorage.getItem(this.storageKey);return e?o.Y.deserialize(JSON.parse(e)):null}removeLocalStorageAuthToken(){this.copilotLocalStorage.removeItem(this.storageKey)}async validateAuthToken(e){return e.needsRefreshing(this.ssoOrgIDs)?this.fetchAuthToken():e}fetchAuthToken(){return this.currentAuthTokenRequest||(this.currentAuthTokenRequest=this._fetchAuthToken()),this.currentAuthTokenRequest}async _fetchAuthToken(){let e=await (0,a.lS)(this.tokenEndpoint,{method:"POST"});if(e.ok){let t=await e.json();this.currentAuthTokenRequest=null;let r=o.Y.fromResult(t,this.ssoOrgIDs);return this.setLocalStorageAuthToken(r),r}throw this.currentAuthTokenRequest=null,Error("Failed to mint new auth token")}constructor(e,t="/github-copilot/chat/token",r="COPILOT_AUTH_TOKEN"){(0,n._)(this,"tokenEndpoint",void 0),(0,n._)(this,"storageKey",void 0),(0,n._)(this,"ssoOrgIDs",void 0),(0,n._)(this,"currentAuthTokenRequest",void 0),(0,n._)(this,"copilotLocalStorage",void 0),this.ssoOrgIDs=e,this.currentAuthTokenRequest=null,this.copilotLocalStorage=(0,i.A)("localStorage",{throwQuotaErrorsOnSet:!1,ttl:864e5}),this.storageKey=r,this.tokenEndpoint=t}}},53419:(e,t,r)=>{let n;r.d(t,{BI:()=>m,Ti:()=>f,lA:()=>d,sX:()=>g});var o=r(70837),i=r(18679),a=r(82075),s=r(11083);let{getItem:l}=(0,a.A)("localStorage"),u="dimension_",c=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","scid"];try{let e=(0,o.O)("octolytics");delete e.baseContext,n=new i.s(e)}catch{}function h(e){let t=(0,o.O)("octolytics").baseContext||{};if(t)for(let[e,r]of(delete t.app_id,delete t.event_url,delete t.host,Object.entries(t)))e.startsWith(u)&&(t[e.replace(u,"")]=r,delete t[e]);let r=document.querySelector("meta[name=visitor-payload]");for(let[e,n]of(r&&Object.assign(t,JSON.parse(atob(r.content))),new URLSearchParams(window.location.search)))c.includes(e.toLowerCase())&&(t[e]=n);return t.staff=(0,s.X)().toString(),Object.assign(t,e)}function d(e){n?.sendPageView(h(e))}function g(){return document.head?.querySelector('meta[name="current-catalog-service"]')?.content}function m(e,t={}){let r=g(),o=r?{service:r}:{};for(let[e,r]of Object.entries(t))null!=r&&(o[e]=`${r}`);n&&(h(o),n.sendEvent(e||"unknown",h(o)))}function f(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,JSON.stringify(t)]))}},96379:(e,t,r)=>{r.d(t,{DI:()=>i,QJ:()=>s,Sr:()=>l,lS:()=>a});var n=r(51987),o=r(88057);async function i(e,t={}){var r=e;if(new URL(r,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch");let a=function(e){let t=new URL(e,window.location.href),r=new URL(window.location.href,window.location.origin),n=r.searchParams.get("_features");n&&!t.searchParams.has("_features")&&t.searchParams.set("_features",n);let o=r.searchParams.get("_tracing");return o&&!t.searchParams.has("_tracing")&&t.searchParams.set("_tracing",o),e.startsWith(window.location.origin)?t.href:`${t.pathname}${t.search}`}(e),s={...t.headers,"GitHub-Verified-Fetch":"true",...(0,n.kt)()},l=await fetch(a,{...t,headers:s}),u=l?.headers?.get("X-Github-Request-Id");return u&&(0,o.Ex)(u),l}function a(e,t){let r={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},n=t?.body?JSON.stringify(t.body):void 0;return i(e,{...t,body:n,headers:r})}function s(e,t={}){let r={...t.headers,"GitHub-Is-React":"true"};return i(e,{...t,headers:r})}function l(e,t){let r={...t?.headers??{},"GitHub-Is-React":"true"};return a(e,{...t,headers:r})}},97189:(e,t,r)=>{r.d(t,{Fn:()=>l,eS:()=>s});var n=r(74848),o=r(21728),i=r(96540);let a=(0,i.createContext)(void 0);function s(){let e=(0,i.useContext)(a);if(!e)throw Error("useConsecutiveCAPI401sContext must be used within a ConsecutiveCAPI401sProvider");return e}function l(e){let t,r,s,l,c,h=(0,o.c)(7),{children:d}=e,[g,m]=(0,i.useState)(0);return h[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>m(u),s=()=>m(0),h[0]=r,h[1]=s):(r=h[0],s=h[1]),h[2]!==g?(l={numberOf401s:g,increment401s:r,reset401s:s},h[2]=g,h[3]=l):l=h[3],t=l,h[4]!==d||h[5]!==t?(c=(0,n.jsx)(a.Provider,{value:t,children:d}),h[4]=d,h[5]=t,h[6]=c):c=h[6],c}function u(e){return e+1}try{a.displayName||(a.displayName="ConsecutiveCAPI401sContext")}catch{}try{l.displayName||(l.displayName="ConsecutiveCAPI401sProvider")}catch{}},32051:(e,t,r)=>{r.d(t,{mE:()=>l,mV:()=>s});var n=r(74848),o=r(21728),i=r(96540);let a=(0,i.createContext)(void 0);function s(){let e=(0,i.useContext)(a);if(!e)throw Error("usePullContext must be used within a PullContextProvider");return e}function l(e){let t,r,i,s=(0,o.c)(5),{pull:l,children:u}=e;return s[0]!==l?(r={pull:l},s[0]=l,s[1]=r):r=s[1],t=r,s[2]!==u||s[3]!==t?(i=(0,n.jsx)(a.Provider,{value:t,children:u}),s[2]=u,s[3]=t,s[4]=i):i=s[4],i}try{a.displayName||(a.displayName="PullContext")}catch{}try{l.displayName||(l.displayName="PullContextProvider")}catch{}},42455:(e,t,r)=>{r.d(t,{b:()=>l});var n=r(97286),o=r(51120),i=r(97189),a=r(34295),s=r(96540);function l(...e){let t=(0,n.I)(...e),{numberOf401s:r,increment401s:u,reset401s:c}=(0,i.eS)(),{isError:h,isLoading:d,error:g}=t;return(0,s.useEffect)(()=>{h&&g instanceof o.j?u():h||d?r>5&&(new a.l().removeLocalStorageAuthToken(),c()):c()},[h,d,g,u,c,r]),t}},34001:(e,t,r)=>{r.d(t,{t:()=>u});var n=r(21728),o=r(42455),i=r(67154),a=r(78314),s=r(51120),l=r(96540);function u(e){let t,r,i,u,d,g=(0,n.c)(18),{pullId:m,initialData:f,sessionsPollingInterval:p}=e,w=(0,a.t)(),[v,y]=(0,l.useState)(0),[_,T]=(0,l.useState)(!1),C=v>0&&!_;g[0]!==m||g[1]!==w.name||g[2]!==w.ownerLogin?(t=["agent-sessions",w.ownerLogin,w.name,m],g[0]=m,g[1]=w.name,g[2]=w.ownerLogin,g[3]=t):t=g[3],g[4]!==m?(r=async()=>{try{let e=await (0,s.I)({path:`/agents/sessions/resource/pull/${m}`}),t=(await e.json()).sessions;return y(0),T(!1),t.sort(h)}catch(e){throw y(e=>{let t=e+1;return t>=10&&T(!0),t}),e}},g[4]=m,g[5]=r):r=g[5],g[6]!==p?(i=e=>{let t=e.state.data;return t?t.some(c)?p:10*p:p},g[6]=p,g[7]=i):i=g[7];let k=v<10;g[8]!==f||g[9]!==t||g[10]!==r||g[11]!==i||g[12]!==k?(u={queryKey:t,queryFn:r,initialData:f,refetchInterval:i,enabled:k},g[8]=f,g[9]=t,g[10]=r,g[11]=i,g[12]=k,g[13]=u):u=g[13];let b=(0,o.b)(u);return g[14]!==C||g[15]!==b||g[16]!==_?(d={...b,timedOut:_,isRetrying:C},g[14]=C,g[15]=b,g[16]=_,g[17]=d):d=g[17],d}function c(e){return e.state===i.Yj.InProgress||e.state===i.Yj.Idle||e.state===i.Yj.WaitingForUser||e.state===i.Yj.Queued}function h(e,t){return new Date(t.created_at).getTime()-new Date(e.created_at).getTime()}},78314:(e,t,r)=>{r.d(t,{d:()=>s,t:()=>l});var n=r(74848),o=r(21728),i=r(96540);let a=i.createContext({});function s(e){let t,r=(0,o.c)(3),{repository:i,children:s}=e;return r[0]!==s||r[1]!==i?(t=(0,n.jsxs)(a.Provider,{value:i,children:[" ",s," "]}),r[0]=s,r[1]=i,r[2]=t):t=r[2],t}function l(){return i.useContext(a)}try{a.displayName||(a.displayName="CurrentRepositoryContext")}catch{}try{s.displayName||(s.displayName="CurrentRepositoryProvider")}catch{}},18679:(e,t,r)=>{r.d(t,{s:()=>AnalyticsClient});let n=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","scid"];var o=r(36301);let AnalyticsClient=class AnalyticsClient{constructor(e){this.options=e}get collectorUrl(){return this.options.collectorUrl}get clientId(){return this.options.clientId?this.options.clientId:(0,o.y)()}createEvent(e){return{page:location.href,title:document.title,context:{...this.options.baseContext,...function(){let e={};try{for(let[t,r]of new URLSearchParams(window.location.search)){let o=t.toLowerCase();n.includes(o)&&(e[o]=r)}return e}catch(e){return{}}}(),...e}}}sendPageView(e){let t=this.createEvent(e);this.send({page_views:[t]})}sendEvent(e,t){let r={...this.createEvent(t),type:e};this.send({events:[r]})}send({page_views:e,events:t}){let r=JSON.stringify({client_id:this.clientId,page_views:e,events:t,request_context:{referrer:function(){let e;try{e=window.top.document.referrer}catch(t){if(window.parent)try{e=window.parent.document.referrer}catch(e){}}return""===e&&(e=document.referrer),e}(),user_agent:navigator.userAgent,screen_resolution:function(){try{return`${screen.width}x${screen.height}`}catch(e){return"unknown"}}(),browser_resolution:function(){let e=0,t=0;try{return"number"==typeof window.innerWidth?(t=window.innerWidth,e=window.innerHeight):null!=document.documentElement&&null!=document.documentElement.clientWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):null!=document.body&&null!=document.body.clientWidth&&(t=document.body.clientWidth,e=document.body.clientHeight),`${t}x${e}`}catch(e){return"unknown"}}(),browser_languages:navigator.languages?navigator.languages.join(","):navigator.language||"",pixel_ratio:window.devicePixelRatio,timestamp:Date.now(),tz_seconds:-60*new Date().getTimezoneOffset()}});try{if(navigator.sendBeacon)return void navigator.sendBeacon(this.collectorUrl,r)}catch{}fetch(this.collectorUrl,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:r,keepalive:!1})}}},70837:(e,t,r)=>{r.d(t,{O:()=>n});function n(e="ha"){let t,r={};for(let n of Array.from(document.head.querySelectorAll(`meta[name^="${e}-"]`))){let{name:o,content:i}=n,a=o.replace(`${e}-`,"").replace(/-/g,"_");"url"===a?t=i:r[a]=i}if(!t)throw Error(`AnalyticsClient ${e}-url meta tag not found`);return{collectorUrl:t,...Object.keys(r).length>0?{baseContext:r}:{}}}},97286:(e,t,r)=>{r.d(t,{I:()=>i});var n=r(1651),o=r(15985);function i(e,t){return(0,o.t)(e,n.$,t)}}}]);
//# sourceMappingURL=packages_agent-sessions_utils_elapsed-time-util_ts-packages_hydro-analytics_hydro-analytics_t-e23c79-3f9794a42deb.js.map